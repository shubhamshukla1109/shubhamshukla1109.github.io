(function(){var e;e=function(){function e(){}return e.prototype.show_why_lend=function(){return $("#why_lend_msg").show(),$("#lend_message_output").hide()},e.prototype.hide_why_lend=function(){return $("#why_lend_msg").hide(),$("#lend_message_output").show()},e.prototype.set_tab=function(){var e;return e=window.Milaap.common.params("tab_id"),e.length>0?$("a[href$=#"+e+"]")[0].click():$(".nav-tabs a[data-toggle='tab']").first().click()},e.prototype.set_form_field=function(e,t,r){return $(e+" #user_"+t).val(r)},e.prototype.update_form_data=function(e,t){var r;return r=$(e),r.attr("action","/users/"+t),$.ajax({url:"/user/"+t,type:"GET",dataType:"json",global:!1,success:function(t){return function(r){var n,o,a,s,i;s=r,o={pan_card_no:s.pan_card_no,name_as_in_pan_card:s.name_as_in_pan_card,address_line1:s.address.address_line1,address_line2:s.address.address_line2,city:s.address.city,state:s.address.state,country:s.address.country,pincode:s.address.pincode},a=[];for(n in o)i=o[n],a.push(t.set_form_field(e,n,i));return a}}(this),error:function(){return function(e){return alert(e.error)}}(this)})},e.prototype.show_user_details_form=function(e,t){var r,n,o;return $(".user-details-form").html("").slideUp("slow"),n="#user-details-form_"+e,r=$(n),r.html($(".user_details_form_for_receipt_download").html()),o=n+" form#update-user-details",this.update_form_data(o,t),r.slideDown("slow"),$(".click-after-user-update").removeClass("click-after-user-update"),$(this).prev().hasClass("download-80g-receipt-link")?$(this).prev().addClass("click-after-user-update"):$(this).next().hasClass("no-tax-receipt-link")&&$(this).next().addClass("click-after-user-update"),window.Milaap.common.validate_ajax_form($("#user-details-form_"+e+" #update-user-details"))},e.prototype.show_modal_with_message=function(e){return $("#tax_exempt_confirmation .modal-body").html(e),$("#tax_exempt_confirmation").modal("show")},e.prototype.download_csv=function(e){return $.ajax({url:e,type:"get",dataType:"json",success:function(e){return function(t){return e.show_modal_with_message(t.message)}}(this),error:function(e){return function(t){return e.show_modal_with_message(t.responseJSON.error)}}(this)})},e}(),$(document).ready(function(){return window.Milaap.User=new e,window.Milaap.User.set_tab(),$("#edit-user-form").formValidation(),$("#manage-password").length>0&&$("#manage-password").formValidation(),$("#why_lend").click(function(){return window.Milaap.User.show_why_lend()}),$("#user_location").change(function(){return $("#user_location option:selected").each(function(){var e;return e=$(this).data("country_code"),e?$("#user_phone_country_code").val(e):void 0})}).trigger("change"),$("#user_phone_num").keydown(function(e){return-1!==$.inArray(e.keyCode,[46,8,9,27,13])||65===e.keyCode&&e.ctrlKey===!0||e.keyCode>=35&&e.keyCode<=39||e.keyCode>=48&&e.keyCode<=57&&e.shiftKey===!1?void($("#user_phone_num").val().length>5?$(".edit-user-btn").removeAttr("disabled"):$(".edit-user-btn").attr("disabled","disabled")):e.preventDefault()}),$(document).on("click","#borrower_filters input:checkbox",function(){return $("#borrower_filters").submit()}),$(document).on("click","#user_edit input:checkbox",function(){return $("#user_edit").submit()}),$(document).on("click",".project-details-link",function(){return $(this).text("See details"===$(this).text()?"Hide details ":"See details"),$("#project-account-details-"+$(this).data("project-id")).slideToggle("slow"),!1}),$(document).on("click","#user_auto_lend",function(){return $(this).is(":checked")?($("#more_info_disabled").addClass("hide"),$("#more_info_enabled").removeClass("hide"),$(".user_preferred_cause_id").removeClass("hide")):($("#more_info_disabled").removeClass("hide"),$("#more_info_enabled").addClass("hide"),$(".user_preferred_cause_id").addClass("hide"))}),$(document).on("click",".close",function(){var e;e=$(this).data("donation-id"),$(".user-details-form").html("").slideUp("slow")}),$(document).on("click",".user-details-form-link",function(){window.Milaap.User.show_user_details_form($(this).data("payment-id"),$(this).data("contributor-id"))}),$(document).on("click",".download_tax_csv",function(e){return e.preventDefault(),window.Milaap.User.download_csv(e.target.href)})})}).call(this);